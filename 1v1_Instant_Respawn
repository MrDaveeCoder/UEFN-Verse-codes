using {/Fortnite.com/Devices}
using {/Verse.org/Simulation}
using {/UnrealEngine.com/Temporary/Diagnostics}
using {/Fortnite.com/Teams}
using {/Verse.org/Simulation}
using {/Fortnite.com/Characters}
using {/Verse.org/Random}
using {/Fortnite.com/Game}
using {/Fortnite.com/FortPlayerUtilities}
using {/UnrealEngine.com/Temporary/SpatialMath}
 
Instant_Respawn := class(creative_device):

    # This respawnposition will determin where the player will face after respawn. This is in default settings but if you need to you can change the X, Y, Z.
    respawnposition: vector3=vector3{X := 250.00, Y := 0.0, Z := 0.0}

    # Elimination manager to check when a player gets eliminated.
    @editable
    EliminationManager : elimination_manager_device = elimination_manager_device{}

    # Teleporters for both players. This is where they will respawn if they are eliminated.
    @editable
    Teleporter1 : teleporter_device = teleporter_device{}
    @editable
    Teleporter2 : teleporter_device = teleporter_device{}
 
    OnBegin<override>()<suspends>:void=
        EliminationManager.EliminatedEvent.Subscribe(SelfEliminated)

    # This will respawn the player after a short amount of time.
    NowRespawn(Agent : agent)<suspends>:void=
        Sleep(0.1)
        Agent.Respawn(respawnposition, rotation{})
        Teleporter1.Teleport(Agent)
        Teleporter1.Teleport(Agent)
    
    SelfEliminated(Agent : agent):void=
        spawn{NowRespawn(Agent)}
